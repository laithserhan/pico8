pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
function _init()
 poke(0x5f38,2)
 poke(0x5f39,2)
end
local dz,dy=0,0
local cx,cy,cz=0,2,0
local angle=0
function _update()
 if(btn(2)) dz-=1/16
 if(btn(3)) dz+=1/16
 
 if(btn(0)) angle-=1/64
 if(btn(1)) angle+=1/64
 
 if(btn(4)) dy=0.2
 
 cx+=dz*sin(angle)
 cz+=-dz*cos(angle)
 cy=max(cy+dy,1)
 dy-=0.02
 --cy=abs(5*cos(time()/16))
	dz*=0.8
end

function _draw() 
 cls()
 local a=angle--time()/4
 local ca,sa=cos(a),-sin(a)
 local cx,cy,cz=cx>>2,cy<<4,cz>>2
	for ye=65,127,4 do
		local rz0,rz1=cy/(ye-64),cy/(ye-60)
		local sz0_0,sz0_1=sa*rz0+cx,ca*rz0+cz
		local sz1_0,sz1_1=sa*rz1+cx,ca*rz1+cz
  rz0=rz0>>6
  rz1=rz1>>6
  -- dda version of
  -- (x1-x0)/4
  local ddx=ca*(rz1-rz0)
		local dx=-ddx+sz1_0-sz0_0
  local ddz=sa*(rz1-rz0)
		local dz=-ddz+sz1_1-sz0_1
		local rx0,rx1=-rz0*64,-rz1*64
  for xe=0,127 do
			-- coords in world space (far)
			local x0,z0=ca*rx0+sz0_0,-sa*rx0+sz0_1
	 	--rectfill(0,ye,127,ye,zcam*16)	
	  tline(xe,ye,xe,ye+3,x0,z0,dx>>2,dz>>2)
   rx0+=rz0
   rx1+=rz1
   dx+=ddx
   dz+=ddz
  end
 end
 print(stat(1),2,2,7)
 print(cx.."/"..cz,2,8,7)
end
__gfx__
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700888888882299992200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000888888882299992200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000888888882299992200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700888888882299992200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000222222228888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0102000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
